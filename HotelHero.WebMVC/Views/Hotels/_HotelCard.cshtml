@using HotelHero.HotelsDatabase;
@using HotelHero.UserPanel.Enums
@using HotelHero.WebMVC.Interface
@model HotelHero.WebMVC.Models.Hotel;
@inject ICustomerDataService customerDataService;

@{
	ViewData["Title"] = "Index";
}

<div class="card mb-3" style="max-width: 650px;">
	<div class="row g-0">
		<div class="col-md-4">
			<img src="@Model.Image" class="img-fluid rounded-start" alt="...">
		</div>
		<div class="col-md-8">
			<div class="card-body">
				<div class="d-inline-block p-1">
					<h5 class="card-title">@Model.Name</h5>
				</div>
				<div class="d-inline-block p-1">
					<p class="card-text">@Model.CreateStars()</p>
				</div>
				<div class="card-text">@Model.City, @Model.Address</div>
				<div class="card-text">
					@if (Model.Description.Length < 100)
					{
						<label>@Model.Description.Substring(0, @Model.Description.Length)...</label>
					}
					else
					{
						<label>@Model.Description.Substring(0, 100)...</label>
					}
					</div>
				<a class="btn btn-outline-primary me2" asp-action="Details" asp-route-id="@Model.Id">Details</a>

				@if (UserContext.loggedUser != null)
				{
					var customerFavourites = customerDataService.GetCustomerData(UserContext.loggedUser.UserId).Favourites;
					if (customerFavourites == null)
					{
						customerFavourites = new();
					}
					if (customerFavourites.Contains(Model.Id))
					{
						<a class="btn btn-outline-primary me2" asp-action="Unfavourite" asp-route-id="@Model.Id">Unfavourite</a>
					}
					else
					{
						<a class="btn btn-outline-primary me2" asp-action="Favourite" asp-route-id="@Model.Id">Favourite</a>
					}
				}

				@if (UserContext.loggedUser != null && UserContext.loggedUser.UserRole == UserRole.Admin)
				{
					<a class="btn btn-outline-primary me2" asp-action="Edit" asp-route-id="@Model.Id">Edit</a>
					<a class="btn btn-outline-danger me2" asp-action="Delete" asp-route-id="@Model.Id">Delete</a>
				}
			</div>
		</div>
	</div>
</div>

